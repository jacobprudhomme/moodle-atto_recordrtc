if (typeof __coverage__ === 'undefined') { __coverage__ = {}; }
if (!__coverage__['build/moodle-atto_recordrtc-button/moodle-atto_recordrtc-button.js']) {
   __coverage__['build/moodle-atto_recordrtc-button/moodle-atto_recordrtc-button.js'] = {"path":"build/moodle-atto_recordrtc-button/moodle-atto_recordrtc-button.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"fnMap":{"1":{"name":"(anonymous_1)","line":1,"loc":{"start":{"line":1,"column":40},"end":{"line":1,"column":59}}},"2":{"name":"(anonymous_2)","line":102,"loc":{"start":{"line":102,"column":17},"end":{"line":102,"column":28}}},"3":{"name":"(anonymous_3)","line":120,"loc":{"start":{"line":120,"column":40},"end":{"line":120,"column":51}}},"4":{"name":"(anonymous_4)","line":139,"loc":{"start":{"line":139,"column":49},"end":{"line":139,"column":65}}},"5":{"name":"(anonymous_5)","line":149,"loc":{"start":{"line":149,"column":43},"end":{"line":149,"column":60}}},"6":{"name":"(anonymous_6)","line":152,"loc":{"start":{"line":152,"column":44},"end":{"line":152,"column":62}}},"7":{"name":"(anonymous_7)","line":155,"loc":{"start":{"line":155,"column":46},"end":{"line":155,"column":59}}},"8":{"name":"(anonymous_8)","line":166,"loc":{"start":{"line":166,"column":16},"end":{"line":166,"column":41}}},"9":{"name":"(anonymous_9)","line":184,"loc":{"start":{"line":184,"column":12},"end":{"line":184,"column":23}}},"10":{"name":"(anonymous_10)","line":206,"loc":{"start":{"line":206,"column":12},"end":{"line":206,"column":23}}},"11":{"name":"(anonymous_11)","line":228,"loc":{"start":{"line":228,"column":20},"end":{"line":228,"column":35}}},"12":{"name":"(anonymous_12)","line":263,"loc":{"start":{"line":263,"column":19},"end":{"line":263,"column":35}}},"13":{"name":"(anonymous_13)","line":276,"loc":{"start":{"line":276,"column":13},"end":{"line":276,"column":41}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":444,"column":3}},"2":{"start":{"line":50,"column":0},"end":{"line":94,"column":13}},"3":{"start":{"line":96,"column":0},"end":{"line":435,"column":3}},"4":{"start":{"line":104,"column":8},"end":{"line":104,"column":52}},"5":{"start":{"line":105,"column":8},"end":{"line":107,"column":9}},"6":{"start":{"line":106,"column":12},"end":{"line":106,"column":50}},"7":{"start":{"line":108,"column":8},"end":{"line":110,"column":9}},"8":{"start":{"line":109,"column":12},"end":{"line":109,"column":50}},"9":{"start":{"line":113,"column":8},"end":{"line":116,"column":11}},"10":{"start":{"line":119,"column":8},"end":{"line":119,"column":26}},"11":{"start":{"line":120,"column":8},"end":{"line":146,"column":11}},"12":{"start":{"line":121,"column":12},"end":{"line":123,"column":99}},"13":{"start":{"line":125,"column":12},"end":{"line":145,"column":13}},"14":{"start":{"line":126,"column":16},"end":{"line":132,"column":17}},"15":{"start":{"line":128,"column":20},"end":{"line":128,"column":46}},"16":{"start":{"line":131,"column":20},"end":{"line":131,"column":60}},"17":{"start":{"line":134,"column":16},"end":{"line":136,"column":17}},"18":{"start":{"line":135,"column":20},"end":{"line":135,"column":43}},"19":{"start":{"line":138,"column":16},"end":{"line":144,"column":17}},"20":{"start":{"line":139,"column":20},"end":{"line":143,"column":23}},"21":{"start":{"line":140,"column":24},"end":{"line":142,"column":25}},"22":{"start":{"line":141,"column":28},"end":{"line":141,"column":41}},"23":{"start":{"line":149,"column":8},"end":{"line":151,"column":11}},"24":{"start":{"line":150,"column":12},"end":{"line":150,"column":35}},"25":{"start":{"line":152,"column":8},"end":{"line":154,"column":11}},"26":{"start":{"line":153,"column":12},"end":{"line":153,"column":37}},"27":{"start":{"line":155,"column":8},"end":{"line":157,"column":11}},"28":{"start":{"line":156,"column":12},"end":{"line":156,"column":27}},"29":{"start":{"line":167,"column":8},"end":{"line":175,"column":11}},"30":{"start":{"line":185,"column":8},"end":{"line":185,"column":42}},"31":{"start":{"line":187,"column":8},"end":{"line":187,"column":36}},"32":{"start":{"line":188,"column":8},"end":{"line":188,"column":87}},"33":{"start":{"line":189,"column":8},"end":{"line":189,"column":66}},"34":{"start":{"line":191,"column":8},"end":{"line":191,"column":24}},"35":{"start":{"line":193,"column":8},"end":{"line":197,"column":9}},"36":{"start":{"line":194,"column":12},"end":{"line":194,"column":59}},"37":{"start":{"line":196,"column":12},"end":{"line":196,"column":52}},"38":{"start":{"line":207,"column":8},"end":{"line":207,"column":42}},"39":{"start":{"line":209,"column":8},"end":{"line":209,"column":36}},"40":{"start":{"line":210,"column":8},"end":{"line":210,"column":87}},"41":{"start":{"line":211,"column":8},"end":{"line":211,"column":66}},"42":{"start":{"line":213,"column":8},"end":{"line":213,"column":24}},"43":{"start":{"line":215,"column":8},"end":{"line":219,"column":9}},"44":{"start":{"line":216,"column":12},"end":{"line":216,"column":59}},"45":{"start":{"line":218,"column":12},"end":{"line":218,"column":52}},"46":{"start":{"line":229,"column":8},"end":{"line":235,"column":90}},"47":{"start":{"line":237,"column":8},"end":{"line":252,"column":11}},"48":{"start":{"line":254,"column":8},"end":{"line":254,"column":27}},"49":{"start":{"line":264,"column":8},"end":{"line":264,"column":35}},"50":{"start":{"line":266,"column":8},"end":{"line":266,"column":29}},"51":{"start":{"line":277,"column":8},"end":{"line":277,"column":35}},"52":{"start":{"line":279,"column":8},"end":{"line":279,"column":29}},"53":{"start":{"line":280,"column":8},"end":{"line":280,"column":64}},"54":{"start":{"line":281,"column":8},"end":{"line":281,"column":28}}},"branchMap":{"1":{"line":105,"type":"if","locations":[{"start":{"line":105,"column":8},"end":{"line":105,"column":8}},{"start":{"line":105,"column":8},"end":{"line":105,"column":8}}]},"2":{"line":105,"type":"binary-expr","locations":[{"start":{"line":105,"column":12},"end":{"line":105,"column":35}},{"start":{"line":105,"column":39},"end":{"line":105,"column":63}}]},"3":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":8},"end":{"line":108,"column":8}},{"start":{"line":108,"column":8},"end":{"line":108,"column":8}}]},"4":{"line":108,"type":"binary-expr","locations":[{"start":{"line":108,"column":12},"end":{"line":108,"column":35}},{"start":{"line":108,"column":39},"end":{"line":108,"column":63}}]},"5":{"line":123,"type":"cond-expr","locations":[{"start":{"line":123,"column":30},"end":{"line":123,"column":66}},{"start":{"line":123,"column":69},"end":{"line":123,"column":98}}]},"6":{"line":125,"type":"if","locations":[{"start":{"line":125,"column":12},"end":{"line":125,"column":12}},{"start":{"line":125,"column":12},"end":{"line":125,"column":12}}]},"7":{"line":126,"type":"if","locations":[{"start":{"line":126,"column":16},"end":{"line":126,"column":16}},{"start":{"line":126,"column":16},"end":{"line":126,"column":16}}]},"8":{"line":134,"type":"if","locations":[{"start":{"line":134,"column":16},"end":{"line":134,"column":16}},{"start":{"line":134,"column":16},"end":{"line":134,"column":16}}]},"9":{"line":134,"type":"binary-expr","locations":[{"start":{"line":134,"column":20},"end":{"line":134,"column":35}},{"start":{"line":134,"column":39},"end":{"line":134,"column":75}}]},"10":{"line":138,"type":"if","locations":[{"start":{"line":138,"column":16},"end":{"line":138,"column":16}},{"start":{"line":138,"column":16},"end":{"line":138,"column":16}}]},"11":{"line":140,"type":"if","locations":[{"start":{"line":140,"column":24},"end":{"line":140,"column":24}},{"start":{"line":140,"column":24},"end":{"line":140,"column":24}}]},"12":{"line":193,"type":"if","locations":[{"start":{"line":193,"column":8},"end":{"line":193,"column":8}},{"start":{"line":193,"column":8},"end":{"line":193,"column":8}}]},"13":{"line":215,"type":"if","locations":[{"start":{"line":215,"column":8},"end":{"line":215,"column":8}},{"start":{"line":215,"column":8},"end":{"line":215,"column":8}}]},"14":{"line":230,"type":"cond-expr","locations":[{"start":{"line":230,"column":46},"end":{"line":230,"column":57}},{"start":{"line":230,"column":60},"end":{"line":230,"column":65}}]},"15":{"line":231,"type":"cond-expr","locations":[{"start":{"line":231,"column":46},"end":{"line":231,"column":52}},{"start":{"line":231,"column":55},"end":{"line":231,"column":64}}]},"16":{"line":232,"type":"cond-expr","locations":[{"start":{"line":232,"column":49},"end":{"line":232,"column":51}},{"start":{"line":232,"column":54},"end":{"line":232,"column":69}}]},"17":{"line":233,"type":"cond-expr","locations":[{"start":{"line":233,"column":49},"end":{"line":233,"column":62}},{"start":{"line":233,"column":65},"end":{"line":233,"column":79}}]},"18":{"line":234,"type":"cond-expr","locations":[{"start":{"line":234,"column":48},"end":{"line":234,"column":84}},{"start":{"line":235,"column":48},"end":{"line":235,"column":89}}]}},"code":["(function () { YUI.add('moodle-atto_recordrtc-button', function (Y, NAME) {","","// This file is part of Moodle - http://moodle.org/","//","// Moodle is free software: you can redistribute it and/or modify","// it under the terms of the GNU General Public License as published by","// the Free Software Foundation, either version 3 of the License, or","// (at your option) any later version.","//","// Moodle is distributed in the hope that it will be useful,","// but WITHOUT ANY WARRANTY; without even the implied warranty of","// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the","// GNU General Public License for more details.","//","// You should have received a copy of the GNU General Public License","// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.","//","","/**"," * Atto recordrtc library functions"," *"," * @package    atto_recordrtc"," * @author     Jesus Federico (jesus [at] blindsidenetworks [dt] com)"," * @author     Jacob Prud'homme (jacob [dt] prudhomme [at] blindsidenetworks [dt] com)"," * @copyright  2017 Blindside Networks Inc."," * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later"," */","","/**"," * @module moodle-atto_recordrtc-button"," */","","/**"," * Atto text editor recordrtc plugin."," *"," * @namespace M.atto_recordrtc"," * @class button"," * @extends M.editor_atto.EditorPlugin"," */","","// JSHint directives.","/*jshint multistr: true */","/*jshint onevar: false */","/*global M */","","// Scrutinizer CI directives.","/** global: Y */","/** global: M */","","var PLUGINNAME = 'atto_recordrtc',","    TEMPLATE = '' +","    '<div class=\"{{PLUGINNAME}} container-fluid\">' +","      '<div class=\"{{bs_row}} hide\">' +","        '<div class=\"{{bs_col}}12\">' +","          '<div id=\"alert-warning\" class=\"alert {{bs_al_warn}}\">' +","            '<strong>{{browseralert_title}}</strong> {{browseralert}}' +","          '</div>' +","        '</div>' +","      '</div>' +","      '<div class=\"{{bs_row}} hide\">' +","        '<div class=\"{{bs_col}}12\">' +","          '<div id=\"alert-danger\" class=\"alert {{bs_al_dang}}\">' +","            '<strong>{{insecurealert_title}}</strong> {{insecurealert}}' +","          '</div>' +","        '</div>' +","      '</div>' +","      '<div class=\"{{bs_row}} hide\">' +","        '{{#if audio}}' +","          '<div class=\"{{bs_col}}1\"></div>' +","          '<div class=\"{{bs_col}}10\">' +","            '<audio id=\"player\"></audio>' +","          '</div>' +","          '<div class=\"{{bs_col}}1\"></div>' +","        '{{else}}' +","          '<div class=\"{{bs_col}}12\">' +","            '<video id=\"player\"></video>' +","          '</div>' +","        '{{/if}}' +","      '</div>' +","      '<div class=\"{{bs_row}}\">' +","        '<div class=\"{{bs_col}}1\"></div>' +","        '<div class=\"{{bs_col}}10\">' +","          '<button id=\"start-stop\" class=\"{{bs_ss_btn}}\">{{startrecording}}</button>' +","        '</div>' +","        '<div class=\"{{bs_col}}1\"></div>' +","      '</div>' +","      '<div class=\"{{bs_row}} hide\">' +","        '<div class=\"{{bs_col}}3\"></div>' +","        '<div class=\"{{bs_col}}6\">' +","          '<button id=\"upload\" class=\"btn btn-primary btn-block\">{{attachrecording}}</button>' +","        '</div>' +","        '<div class=\"{{bs_col}}3\"></div>' +","      '</div>' +","    '</div>';","","Y.namespace('M.atto_recordrtc').Button = Y.Base.create('button', Y.M.editor_atto.EditorPlugin, [], {","    /**","     * The current language by default.","     */","    _lang: 'en',","","    initializer: function() {","        // Add audio and/or video buttons depending on the settings.","        var allowedtypes = this.get('allowedtypes');","        if (allowedtypes === 'both' || allowedtypes === 'audio') {","            this._addButton('audio', this._audio);","        }","        if (allowedtypes === 'both' || allowedtypes === 'video') {","            this._addButton('video', this._video);","        }","","        // Initialize the dialogue box.","        var dialogue = this.getDialogue({","            width: 1000,","            focusAfterHide: null","        });","","        // If dialogue is closed during recording, do the following.","        var editor = this;","        dialogue.after('visibleChange', function() {","            var closed = !dialogue.get('visible'),","                premium = editor.get('premiumservice') === '1',","                m = premium ? M.atto_recordrtc.premiumcommonmodule : M.atto_recordrtc.commonmodule;","","            if (closed) {","                if (premium) {","                    // Disconnect the socket.","                    m.socket.disconnect(true);","                } else {","                    // Clear the countdown timer.","                    window.clearInterval(m.countdownTicker);","                }","","                if (m.mediaRecorder && m.mediaRecorder.state !== 'inactive') {","                    m.mediaRecorder.stop();","                }","","                if (m.stream) {","                    m.stream.getTracks().forEach(function(track) {","                        if (track.readyState !== 'ended') {","                            track.stop();","                        }","                    });","                }","            }","        });","","        // Require Bowser, adapter.js and Socket.io libraries.","        require(['atto_recordrtc/bowser'], function(bowser) {","            window.bowser = bowser;","        });","        require(['atto_recordrtc/adapter'], function(adapter) {","            window.adapter = adapter;","        });","        require(['atto_recordrtc/socket.io'], function(io) {","            window.io = io;","        });","    },","","    /**","     * Add the buttons to the Atto toolbar.","     *","     * @method _addButton","     * @private","     */","    _addButton: function(type, callback) {","        this.addButton({","            buttonName: type,","            icon: this.get(type + 'rtcicon'),","            iconComponent: PLUGINNAME,","            callback: callback,","            title: type + 'rtc',","            tags: type + 'rtc',","            tagMatchRequiresAll: false","        });","    },","","    /**","     * Toggle audiortc and normal display mode","     *","     * @method _audio","     * @private","     */","    _audio: function() {","        var dialogue = this.getDialogue();","","        dialogue.set('height', 260);","        dialogue.set('headerContent', M.util.get_string('audiortc', 'atto_recordrtc'));","        dialogue.set('bodyContent', this._createContent('audio'));","","        dialogue.show();","","        if (this.get('premiumservice') === '1') {","            M.atto_recordrtc.premiumaudiomodule.init(this);","        } else {","            M.atto_recordrtc.audiomodule.init(this);","        }","    },","","    /**","     * Toggle videortc and normal display mode","     *","     * @method _video","     * @private","     */","    _video: function() {","        var dialogue = this.getDialogue();","","        dialogue.set('height', 700);","        dialogue.set('headerContent', M.util.get_string('videortc', 'atto_recordrtc'));","        dialogue.set('bodyContent', this._createContent('video'));","","        dialogue.show();","","        if (this.get('premiumservice') === '1') {","            M.atto_recordrtc.premiumvideomodule.init(this);","        } else {","            M.atto_recordrtc.videomodule.init(this);","        }","    },","","    /**","     * Create the HTML to be displayed in the dialogue box","     *","     * @method _createContent","     * @private","     */","    _createContent: function(type) {","        var audio = (type === 'audio'),","            bsRow = this.get('oldermoodle') ? 'row-fluid' : 'row',","            bsCol = this.get('oldermoodle') ? 'span' : 'col-xs-',","            bsAlWarn = this.get('oldermoodle') ? '' : 'alert-warning',","            bsAlDang = this.get('oldermoodle') ? 'alert-error' : 'alert-danger',","            bsSsBtn = this.get('oldermoodle') ? 'btn btn-large btn-danger btn-block'","                                              : 'btn btn-lg btn-outline-danger btn-block';","","        var bodyContent = Y.Handlebars.compile(TEMPLATE)({","            PLUGINNAME: PLUGINNAME,","            audio: audio,","            bs_row: bsRow,","            bs_col: bsCol,","            bs_al_warn: bsAlWarn,","            bs_al_dang: bsAlDang,","            bs_ss_btn: bsSsBtn,","            bs_ul_btn: 'btn btn-primary btn-block',","            browseralert_title: M.util.get_string('browseralert_title', 'atto_recordrtc'),","            browseralert: M.util.get_string('browseralert', 'atto_recordrtc'),","            insecurealert_title: M.util.get_string('insecurealert_title', 'atto_recordrtc'),","            insecurealert: M.util.get_string('insecurealert', 'atto_recordrtc'),","            startrecording: M.util.get_string('startrecording', 'atto_recordrtc'),","            attachrecording: M.util.get_string('attachrecording', 'atto_recordrtc')","        });","","        return bodyContent;","    },","","    /**","     * Close the dialogue without further action.","     *","     * @method closeDialogue","     * @param {Object} scope The \"this\" context of the editor.","     */","    closeDialogue: function(scope) {","        scope.getDialogue().hide();","","        scope.editor.focus();","    },","","    /**","     * Insert the annotation link in the editor.","     *","     * @method setLink","     * @param {Object} scope The \"this\" context of the editor.","     * @param {String} annotation The HTML link to the recording.","     */","    setLink: function(scope, annotation) {","        scope.getDialogue().hide();","","        scope.editor.focus();","        scope.get('host').insertContentAtFocusPoint(annotation);","        scope.markUpdated();","    }","}, {","    ATTRS: {","        /**","         * The contextid to use when generating this recordrtc.","         *","         * @attribute contextid","         * @type String","         */","        contextid: {","            value: null","        },","","        /**","         * The sesskey to use when generating this recordrtc.","         *","         * @attribute sesskey","         * @type String","         */","        sesskey: {","            value: null","        },","","        /**","         * The root to use when loading the recordrtc.","         *","         * @attribute recordrtcroot","         * @type String","         */","        recordrtcroot: {","            value: null","        },","","        /**","         * The allowedtypes to use when generating this recordrtc.","         *","         * @attribute allowedtypes","         * @type String","         */","        allowedtypes: {","            value: null","        },","","        /**","         * The audiobitrate to use when generating this recordrtc.","         *","         * @attribute audiobitrate","         * @type String","         */","        audiobitrate: {","            value: null","        },","","        /**","         * The videobitrate to use when generating this recordrtc.","         *","         * @attribute videobitrate","         * @type String","         */","        videobitrate: {","            value: null","        },","","        /**","         * The timelimit to use when generating this recordrtc.","         *","         * @attribute timelimit","         * @type String","         */","        timelimit: {","            value: null","        },","","        /**","         * Whether or not to use premium recording service.","         *","         * @attribute premiumservice","         * @type Boolean","         */","        premiumservice: {","            value: null","        },","","        /**","         * The URL of the premium recording server.","         *","         * @attribute serverurl","         * @type String","         */","        serverurl: {","            value: null","        },","","        /**","         * The API key for the premium recording service.","         *","         * @attribute apikey","         * @type String","         */","        apikey: {","            value: null","        },","","        /**","         * The API shared secret for the premium recording service.","         *","         * @attribute apisecret","         * @type String","         */","        apisecret: {","            value: null","        },","","        /**","         * The audiortcicon to use when generating this recordrtc.","         *","         * @attribute audiortcicon","         * @type String","         */","        audiortcicon: {","            value: null","        },","","        /**","         * The videortcicon to use when generating this recordrtc.","         *","         * @attribute videortcicon","         * @type String","         */","        videortcicon: {","            value: null","        },","","        /**","         * True if Moodle is version < 3.2.","         *","         * @attribute oldermoodle","         * @type Boolean","         */","        oldermoodle: {","            value: null","        },","","        /**","         * Maximum upload size set on server, in MB.","         *","         * @attribute maxrecsize","         * @type String","         */","        maxrecsize: {","            value: null","        }","    }","});","","","}, '@VERSION@', {","    \"requires\": [","        \"moodle-editor_atto-plugin\",","        \"moodle-atto_recordrtc-recording\",","        \"moodle-atto_recordrtc-premiumrecording\"","    ]","});","","}());"]};
}
var __cov_rsJHo0SLJfm3n07rFSmtCA = __coverage__['build/moodle-atto_recordrtc-button/moodle-atto_recordrtc-button.js'];
__cov_rsJHo0SLJfm3n07rFSmtCA.s['1']++;YUI.add('moodle-atto_recordrtc-button',function(Y,NAME){__cov_rsJHo0SLJfm3n07rFSmtCA.f['1']++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['2']++;var PLUGINNAME='atto_recordrtc',TEMPLATE=''+'<div class="{{PLUGINNAME}} container-fluid">'+'<div class="{{bs_row}} hide">'+'<div class="{{bs_col}}12">'+'<div id="alert-warning" class="alert {{bs_al_warn}}">'+'<strong>{{browseralert_title}}</strong> {{browseralert}}'+'</div>'+'</div>'+'</div>'+'<div class="{{bs_row}} hide">'+'<div class="{{bs_col}}12">'+'<div id="alert-danger" class="alert {{bs_al_dang}}">'+'<strong>{{insecurealert_title}}</strong> {{insecurealert}}'+'</div>'+'</div>'+'</div>'+'<div class="{{bs_row}} hide">'+'{{#if audio}}'+'<div class="{{bs_col}}1"></div>'+'<div class="{{bs_col}}10">'+'<audio id="player"></audio>'+'</div>'+'<div class="{{bs_col}}1"></div>'+'{{else}}'+'<div class="{{bs_col}}12">'+'<video id="player"></video>'+'</div>'+'{{/if}}'+'</div>'+'<div class="{{bs_row}}">'+'<div class="{{bs_col}}1"></div>'+'<div class="{{bs_col}}10">'+'<button id="start-stop" class="{{bs_ss_btn}}">{{startrecording}}</button>'+'</div>'+'<div class="{{bs_col}}1"></div>'+'</div>'+'<div class="{{bs_row}} hide">'+'<div class="{{bs_col}}3"></div>'+'<div class="{{bs_col}}6">'+'<button id="upload" class="btn btn-primary btn-block">{{attachrecording}}</button>'+'</div>'+'<div class="{{bs_col}}3"></div>'+'</div>'+'</div>';__cov_rsJHo0SLJfm3n07rFSmtCA.s['3']++;Y.namespace('M.atto_recordrtc').Button=Y.Base.create('button',Y.M.editor_atto.EditorPlugin,[],{_lang:'en',initializer:function(){__cov_rsJHo0SLJfm3n07rFSmtCA.f['2']++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['4']++;var allowedtypes=this.get('allowedtypes');__cov_rsJHo0SLJfm3n07rFSmtCA.s['5']++;if((__cov_rsJHo0SLJfm3n07rFSmtCA.b['2'][0]++,allowedtypes==='both')||(__cov_rsJHo0SLJfm3n07rFSmtCA.b['2'][1]++,allowedtypes==='audio')){__cov_rsJHo0SLJfm3n07rFSmtCA.b['1'][0]++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['6']++;this._addButton('audio',this._audio);}else{__cov_rsJHo0SLJfm3n07rFSmtCA.b['1'][1]++;}__cov_rsJHo0SLJfm3n07rFSmtCA.s['7']++;if((__cov_rsJHo0SLJfm3n07rFSmtCA.b['4'][0]++,allowedtypes==='both')||(__cov_rsJHo0SLJfm3n07rFSmtCA.b['4'][1]++,allowedtypes==='video')){__cov_rsJHo0SLJfm3n07rFSmtCA.b['3'][0]++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['8']++;this._addButton('video',this._video);}else{__cov_rsJHo0SLJfm3n07rFSmtCA.b['3'][1]++;}__cov_rsJHo0SLJfm3n07rFSmtCA.s['9']++;var dialogue=this.getDialogue({width:1000,focusAfterHide:null});__cov_rsJHo0SLJfm3n07rFSmtCA.s['10']++;var editor=this;__cov_rsJHo0SLJfm3n07rFSmtCA.s['11']++;dialogue.after('visibleChange',function(){__cov_rsJHo0SLJfm3n07rFSmtCA.f['3']++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['12']++;var closed=!dialogue.get('visible'),premium=editor.get('premiumservice')==='1',m=premium?(__cov_rsJHo0SLJfm3n07rFSmtCA.b['5'][0]++,M.atto_recordrtc.premiumcommonmodule):(__cov_rsJHo0SLJfm3n07rFSmtCA.b['5'][1]++,M.atto_recordrtc.commonmodule);__cov_rsJHo0SLJfm3n07rFSmtCA.s['13']++;if(closed){__cov_rsJHo0SLJfm3n07rFSmtCA.b['6'][0]++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['14']++;if(premium){__cov_rsJHo0SLJfm3n07rFSmtCA.b['7'][0]++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['15']++;m.socket.disconnect(true);}else{__cov_rsJHo0SLJfm3n07rFSmtCA.b['7'][1]++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['16']++;window.clearInterval(m.countdownTicker);}__cov_rsJHo0SLJfm3n07rFSmtCA.s['17']++;if((__cov_rsJHo0SLJfm3n07rFSmtCA.b['9'][0]++,m.mediaRecorder)&&(__cov_rsJHo0SLJfm3n07rFSmtCA.b['9'][1]++,m.mediaRecorder.state!=='inactive')){__cov_rsJHo0SLJfm3n07rFSmtCA.b['8'][0]++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['18']++;m.mediaRecorder.stop();}else{__cov_rsJHo0SLJfm3n07rFSmtCA.b['8'][1]++;}__cov_rsJHo0SLJfm3n07rFSmtCA.s['19']++;if(m.stream){__cov_rsJHo0SLJfm3n07rFSmtCA.b['10'][0]++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['20']++;m.stream.getTracks().forEach(function(track){__cov_rsJHo0SLJfm3n07rFSmtCA.f['4']++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['21']++;if(track.readyState!=='ended'){__cov_rsJHo0SLJfm3n07rFSmtCA.b['11'][0]++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['22']++;track.stop();}else{__cov_rsJHo0SLJfm3n07rFSmtCA.b['11'][1]++;}});}else{__cov_rsJHo0SLJfm3n07rFSmtCA.b['10'][1]++;}}else{__cov_rsJHo0SLJfm3n07rFSmtCA.b['6'][1]++;}});__cov_rsJHo0SLJfm3n07rFSmtCA.s['23']++;require(['atto_recordrtc/bowser'],function(bowser){__cov_rsJHo0SLJfm3n07rFSmtCA.f['5']++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['24']++;window.bowser=bowser;});__cov_rsJHo0SLJfm3n07rFSmtCA.s['25']++;require(['atto_recordrtc/adapter'],function(adapter){__cov_rsJHo0SLJfm3n07rFSmtCA.f['6']++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['26']++;window.adapter=adapter;});__cov_rsJHo0SLJfm3n07rFSmtCA.s['27']++;require(['atto_recordrtc/socket.io'],function(io){__cov_rsJHo0SLJfm3n07rFSmtCA.f['7']++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['28']++;window.io=io;});},_addButton:function(type,callback){__cov_rsJHo0SLJfm3n07rFSmtCA.f['8']++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['29']++;this.addButton({buttonName:type,icon:this.get(type+'rtcicon'),iconComponent:PLUGINNAME,callback:callback,title:type+'rtc',tags:type+'rtc',tagMatchRequiresAll:false});},_audio:function(){__cov_rsJHo0SLJfm3n07rFSmtCA.f['9']++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['30']++;var dialogue=this.getDialogue();__cov_rsJHo0SLJfm3n07rFSmtCA.s['31']++;dialogue.set('height',260);__cov_rsJHo0SLJfm3n07rFSmtCA.s['32']++;dialogue.set('headerContent',M.util.get_string('audiortc','atto_recordrtc'));__cov_rsJHo0SLJfm3n07rFSmtCA.s['33']++;dialogue.set('bodyContent',this._createContent('audio'));__cov_rsJHo0SLJfm3n07rFSmtCA.s['34']++;dialogue.show();__cov_rsJHo0SLJfm3n07rFSmtCA.s['35']++;if(this.get('premiumservice')==='1'){__cov_rsJHo0SLJfm3n07rFSmtCA.b['12'][0]++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['36']++;M.atto_recordrtc.premiumaudiomodule.init(this);}else{__cov_rsJHo0SLJfm3n07rFSmtCA.b['12'][1]++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['37']++;M.atto_recordrtc.audiomodule.init(this);}},_video:function(){__cov_rsJHo0SLJfm3n07rFSmtCA.f['10']++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['38']++;var dialogue=this.getDialogue();__cov_rsJHo0SLJfm3n07rFSmtCA.s['39']++;dialogue.set('height',700);__cov_rsJHo0SLJfm3n07rFSmtCA.s['40']++;dialogue.set('headerContent',M.util.get_string('videortc','atto_recordrtc'));__cov_rsJHo0SLJfm3n07rFSmtCA.s['41']++;dialogue.set('bodyContent',this._createContent('video'));__cov_rsJHo0SLJfm3n07rFSmtCA.s['42']++;dialogue.show();__cov_rsJHo0SLJfm3n07rFSmtCA.s['43']++;if(this.get('premiumservice')==='1'){__cov_rsJHo0SLJfm3n07rFSmtCA.b['13'][0]++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['44']++;M.atto_recordrtc.premiumvideomodule.init(this);}else{__cov_rsJHo0SLJfm3n07rFSmtCA.b['13'][1]++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['45']++;M.atto_recordrtc.videomodule.init(this);}},_createContent:function(type){__cov_rsJHo0SLJfm3n07rFSmtCA.f['11']++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['46']++;var audio=type==='audio',bsRow=this.get('oldermoodle')?(__cov_rsJHo0SLJfm3n07rFSmtCA.b['14'][0]++,'row-fluid'):(__cov_rsJHo0SLJfm3n07rFSmtCA.b['14'][1]++,'row'),bsCol=this.get('oldermoodle')?(__cov_rsJHo0SLJfm3n07rFSmtCA.b['15'][0]++,'span'):(__cov_rsJHo0SLJfm3n07rFSmtCA.b['15'][1]++,'col-xs-'),bsAlWarn=this.get('oldermoodle')?(__cov_rsJHo0SLJfm3n07rFSmtCA.b['16'][0]++,''):(__cov_rsJHo0SLJfm3n07rFSmtCA.b['16'][1]++,'alert-warning'),bsAlDang=this.get('oldermoodle')?(__cov_rsJHo0SLJfm3n07rFSmtCA.b['17'][0]++,'alert-error'):(__cov_rsJHo0SLJfm3n07rFSmtCA.b['17'][1]++,'alert-danger'),bsSsBtn=this.get('oldermoodle')?(__cov_rsJHo0SLJfm3n07rFSmtCA.b['18'][0]++,'btn btn-large btn-danger btn-block'):(__cov_rsJHo0SLJfm3n07rFSmtCA.b['18'][1]++,'btn btn-lg btn-outline-danger btn-block');__cov_rsJHo0SLJfm3n07rFSmtCA.s['47']++;var bodyContent=Y.Handlebars.compile(TEMPLATE)({PLUGINNAME:PLUGINNAME,audio:audio,bs_row:bsRow,bs_col:bsCol,bs_al_warn:bsAlWarn,bs_al_dang:bsAlDang,bs_ss_btn:bsSsBtn,bs_ul_btn:'btn btn-primary btn-block',browseralert_title:M.util.get_string('browseralert_title','atto_recordrtc'),browseralert:M.util.get_string('browseralert','atto_recordrtc'),insecurealert_title:M.util.get_string('insecurealert_title','atto_recordrtc'),insecurealert:M.util.get_string('insecurealert','atto_recordrtc'),startrecording:M.util.get_string('startrecording','atto_recordrtc'),attachrecording:M.util.get_string('attachrecording','atto_recordrtc')});__cov_rsJHo0SLJfm3n07rFSmtCA.s['48']++;return bodyContent;},closeDialogue:function(scope){__cov_rsJHo0SLJfm3n07rFSmtCA.f['12']++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['49']++;scope.getDialogue().hide();__cov_rsJHo0SLJfm3n07rFSmtCA.s['50']++;scope.editor.focus();},setLink:function(scope,annotation){__cov_rsJHo0SLJfm3n07rFSmtCA.f['13']++;__cov_rsJHo0SLJfm3n07rFSmtCA.s['51']++;scope.getDialogue().hide();__cov_rsJHo0SLJfm3n07rFSmtCA.s['52']++;scope.editor.focus();__cov_rsJHo0SLJfm3n07rFSmtCA.s['53']++;scope.get('host').insertContentAtFocusPoint(annotation);__cov_rsJHo0SLJfm3n07rFSmtCA.s['54']++;scope.markUpdated();}},{ATTRS:{contextid:{value:null},sesskey:{value:null},recordrtcroot:{value:null},allowedtypes:{value:null},audiobitrate:{value:null},videobitrate:{value:null},timelimit:{value:null},premiumservice:{value:null},serverurl:{value:null},apikey:{value:null},apisecret:{value:null},audiortcicon:{value:null},videortcicon:{value:null},oldermoodle:{value:null},maxrecsize:{value:null}}});},'@VERSION@',{'requires':['moodle-editor_atto-plugin','moodle-atto_recordrtc-recording','moodle-atto_recordrtc-premiumrecording']});
